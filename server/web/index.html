<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Melody Sync Player - 下载</title>
  <meta name="description" content="Melody Sync Player 跨平台音乐播放器 下载页" />
  <link rel="preconnect" href="https://cdn.jsdelivr.net" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" />
  <style>
    :root { color-scheme: light dark; }
    * { box-sizing: border-box; }
    body { margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Segoe UI Emoji"; background: #0b1220; color: #e5e7eb; }
    a { color: #10b981; text-decoration: none; }
    .wrap { max-width: 1000px; margin: 0 auto; padding: 24px; }
    .hero { text-align: center; margin: 24px 0 16px; }
    .logo { width: 88px; height: 88px; border-radius: 18px; box-shadow: 0 8px 30px rgba(0,0,0,.35); object-fit: cover; }
    .title { font-size: 32px; font-weight: 900; margin: 12px 0 6px; }
    .subtitle { color: #9ca3af; margin-bottom: 14px; }
    .cta { display: flex; justify-content: center; gap: 12px; flex-wrap: wrap; }
    .btn { padding: 10px 16px; border-radius: 10px; border: 1px solid #374151; background: #10b981; color: #071018; font-weight: 700; cursor: pointer; }
    .btn.secondary { background: transparent; color: #e5e7eb; }
    .btn:hover { filter: brightness(1.05); }
    .grid { display: grid; grid-template-columns: repeat(1, minmax(0, 1fr)); gap: 12px; margin: 18px 0 24px; }
    /* 桌面端改为 2 列，呈 2x2 布局 */
    @media (min-width: 768px) { .grid { grid-template-columns: repeat(2, minmax(0, 1fr)); } }
    .card { background: #111827; border: 1px solid #374151; border-radius: 16px; padding: 16px; text-align: center; box-shadow: 0 6px 20px rgba(0,0,0,.25); transition: transform .15s ease, box-shadow .15s ease; min-height: 190px; display:flex;flex-direction:column;justify-content:center }
    .card:hover{ transform: translateY(-2px); box-shadow: 0 10px 28px rgba(0,0,0,.30); }
    .icon { font-size: 32px; color: #10b981; margin-bottom: 6px; }
    h3 { margin: 8px 0 4px; font-size: 18px; }
    p { margin: 0 0 10px; color: #9ca3af; font-size: 14px; }
    .note { background: #0f172a; border: 1px solid #374151; border-radius: 16px; padding: 16px; }
    ul { margin: 8px 0 0 18px; color: #cbd5e1; }
    .footer { text-align: center; margin: 22px 0 8px; color: #9ca3af; font-size: 13px; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="hero">
      <img class="logo" src="/favicon.ico" alt="Melody Sync Player" onerror="this.style.display='none'">
      <div class="title">Melody Sync Player</div>
      <div class="subtitle">跨平台 · 轻量 · 流畅的音乐体验</div>
      <div class="cta">
        <a class="btn" href="http://melodysync.xo.je/" target="_blank" rel="noopener">立即下载</a>
        <a class="btn secondary" href="https://github.com/toot66/MelodySyncPlayer/releases" target="_blank" rel="noopener">从 GitHub 获取</a>
      </div>
    </div>

    <div class="grid" id="cards">
      <div class="card">
        <i class="ri-windows-line icon"></i>
        <h3>Windows</h3>
        <p>兼容 Windows 10/11</p>
        <a id="dl-windows" class="btn secondary" href="http://melodysync.xo.je/" target="_blank" rel="noopener">下载</a>
        <div class="meta"><small id="ver-windows" style="color:#9ca3af"></small> <small id="size-windows" style="color:#64748b;margin-left:6px"></small></div>
      </div>
      <div class="card">
        <i class="ri-apple-line icon"></i>
        <h3>macOS</h3>
        <p>支持 Intel 与 Apple Silicon</p>
        <a id="dl-macos" class="btn secondary" href="http://melodysync.xo.je/" target="_blank" rel="noopener">下载</a>
        <div class="meta"><small id="ver-macos" style="color:#9ca3af"></small> <small id="size-macos" style="color:#64748b;margin-left:6px"></small></div>
      </div>
      <div class="card">
        <i class="ri-linux-line icon"></i>
        <h3>Linux</h3>
        <p>提供 AppImage / deb</p>
        <a id="dl-linux" class="btn secondary" href="http://melodysync.xo.je/" target="_blank" rel="noopener">下载</a>
        <div class="meta"><small id="ver-linux" style="color:#9ca3af"></small> <small id="size-linux" style="color:#64748b;margin-left:6px"></small></div>
      </div>
      <div class="card">
        <i class="ri-android-line icon"></i>
        <h3>Android</h3>
        <p>提供 APK 安装包</p>
        <a id="dl-android" class="btn secondary" href="http://melodysync.xo.je/" target="_blank" rel="noopener">下载</a>
        <div class="meta"><small id="ver-android" style="color:#9ca3af"></small> <small id="size-android" style="color:#64748b;margin-left:6px"></small></div>
      </div>
    </div>

    <div class="note">
      <h3 style="margin:0 0 6px">发布与校验</h3>
      <ul>
        <li>我们会在 GitHub Releases 同步发布安装包。</li>
        <li>若访问缓慢，可使用“立即下载”镜像入口。</li>
        <li>安装前请关闭不必要的安全软件拦截。</li>
      </ul>
    </div>

    <div class="footer">© Melody Sync Player</div>
  </div>

  <script>
  // 动态从 API 获取各平台最新下载链接
  fetch('/api/downloads.php?latest=1').then(r=>r.json()).then(data=>{
    try {
      const map = {
        windows: document.getElementById('dl-windows'),
        macos: document.getElementById('dl-macos'),
        linux: document.getElementById('dl-linux'),
        android: document.getElementById('dl-android')
      };
      Object.keys(map).forEach(k=>{
        const a = map[k];
        const row = data && data[k];
        if (a && row && row.url) {
          a.href = row.url;
          a.textContent = `下载${row.version ? ' ' + row.version : ''}`;
        }
      });
    } catch (e) {}
  }).catch(()=>{});
  </script>
</body>
</html>
